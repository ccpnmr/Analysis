
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ccpn.ui.gui.popups.Dialog &#8212; Python  documentation</title>
    <link rel="stylesheet" href="../../../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
    <script src="../../../../../_static/jquery.js"></script>
    <script src="../../../../../_static/underscore.js"></script>
    <script src="../../../../../_static/doctools.js"></script>
    <script src="../../../../../_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Python  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for ccpn.ui.gui.popups.Dialog</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module Documentation here</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Licence, Reference and Credits</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__copyright__</span> <span class="o">=</span> <span class="s2">&quot;Copyright (C) CCPN project (http://www.ccpn.ac.uk) 2014 - 2020&quot;</span>
<span class="n">__credits__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Ed Brooksbank, Luca Mureddu, Timothy J Ragan &amp; Geerten W Vuister&quot;</span><span class="p">)</span>
<span class="n">__licence__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;CCPN licence. See http://www.ccpn.ac.uk/v3-software/downloads/license&quot;</span><span class="p">)</span>
<span class="n">__reference__</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Skinner, S.P., Fogh, R.H., Boucher, W., Ragan, T.J., Mureddu, L.G., &amp; Vuister, G.W.&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;CcpNmr AnalysisAssign: a flexible platform for integrated NMR analysis&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;J.Biomol.Nmr (2016), 66, 111-124, http://doi.org/10.1007/s10858-016-0060-y&quot;</span><span class="p">)</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Last code modification</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__modifiedBy__</span> <span class="o">=</span> <span class="s2">&quot;$modifiedBy: Ed Brooksbank $&quot;</span>
<span class="n">__dateModified__</span> <span class="o">=</span> <span class="s2">&quot;$dateModified: 2020-01-28 10:04:26 +0000 (Tue, January 28, 2020) $&quot;</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="s2">&quot;$Revision: 3.0.0 $&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Created</span>
<span class="c1">#=========================================================================================</span>
<span class="n">__author__</span> <span class="o">=</span> <span class="s2">&quot;$Author: CCPN $&quot;</span>
<span class="n">__date__</span> <span class="o">=</span> <span class="s2">&quot;$Date: 2017-07-04 15:21:16 +0000 (Tue, July 04, 2017) $&quot;</span>
<span class="c1">#=========================================================================================</span>
<span class="c1"># Start of code</span>
<span class="c1">#=========================================================================================</span>

<span class="kn">from</span> <span class="nn">PyQt5</span> <span class="kn">import</span> <span class="n">QtWidgets</span><span class="p">,</span> <span class="n">QtCore</span><span class="p">,</span> <span class="n">QtGui</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">contextmanager</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Base</span> <span class="kn">import</span> <span class="n">Base</span>
<span class="kn">from</span> <span class="nn">ccpn.util.Logging</span> <span class="kn">import</span> <span class="n">getLogger</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.Frame</span> <span class="kn">import</span> <span class="n">Frame</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.ScrollArea</span> <span class="kn">import</span> <span class="n">ScrollArea</span>
<span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.DialogButtonBox</span> <span class="kn">import</span> <span class="n">DialogButtonBox</span>
<span class="kn">from</span> <span class="nn">ccpn.core.lib.ContextManagers</span> <span class="kn">import</span> <span class="n">undoStackBlocking</span>


<span class="k">def</span> <span class="nf">_updateGl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spectrumList</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">ccpn.ui.gui.lib.OpenGL.CcpnOpenGL</span> <span class="kn">import</span> <span class="n">GLNotifier</span>

    <span class="c1"># # spawn a redraw of the contours</span>
    <span class="c1"># for spec in spectrumList:</span>
    <span class="c1">#     for specViews in spec.spectrumViews:</span>
    <span class="c1">#         specViews.buildContours = True</span>

    <span class="n">GLSignals</span> <span class="o">=</span> <span class="n">GLNotifier</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">GLSignals</span><span class="o">.</span><span class="n">emitPaintEvent</span><span class="p">()</span>


<span class="n">HORIZONTAL</span> <span class="o">=</span> <span class="s1">&#39;horizontal&#39;</span>
<span class="n">VERTICAL</span> <span class="o">=</span> <span class="s1">&#39;vertical&#39;</span>
<span class="n">ORIENTATIONLIST</span> <span class="o">=</span> <span class="p">(</span><span class="n">HORIZONTAL</span><span class="p">,</span> <span class="n">VERTICAL</span><span class="p">)</span>
<span class="n">DEFAULTSPACING</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">DEFAULTMARGINS</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
<span class="n">GETCHANGESDICT</span> <span class="o">=</span> <span class="s1">&#39;getChangesDict&#39;</span>


<div class="viewcode-block" id="CcpnDialogMainWidget"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget">[docs]</a><span class="k">class</span> <span class="nc">CcpnDialogMainWidget</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">Base</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to handle popup dialogs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">RESETBUTTON</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Reset</span>
    <span class="n">CLOSEBUTTON</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Close</span>
    <span class="n">CANCELBUTTON</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Cancel</span>
    <span class="n">APPLYBUTTON</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Apply</span>
    <span class="n">OKBUTTON</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Ok</span>
    <span class="n">HELPBUTTON</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Help</span>
    <span class="n">DEFAULTBUTTON</span> <span class="o">=</span> <span class="n">CLOSEBUTTON</span>

    <span class="n">USESCROLLWIDGET</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">FIXEDWIDTH</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">FIXEDHEIGHT</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">ENABLEICONS</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">EDITMODE</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">windowTitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">orientation</span><span class="o">=</span><span class="n">HORIZONTAL</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">Base</span><span class="o">.</span><span class="n">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="n">setLayout</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">orientation</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">ORIENTATIONLIST</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Error: orientation not in </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">ORIENTATIONLIST</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">windowTitle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="o">*</span><span class="n">DEFAULTMARGINS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">getLayout</span><span class="p">()</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_orientation</span> <span class="o">=</span> <span class="n">orientation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="o">=</span> <span class="n">size</span>

        <span class="c1"># set up the mainWidget area</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span> <span class="o">=</span> <span class="n">Frame</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">showBorder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="o">.</span><span class="n">setAutoFillBackground</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">USESCROLLWIDGET</span><span class="p">:</span>
            <span class="c1"># not resizing correctly on first show</span>

            <span class="c1"># self.mainWidget.setSizePolicy(QtWidgets.QSizePolicy.Ignored, QtWidgets.QSizePolicy.Ignored)</span>
            <span class="c1"># self.mainWidget.setSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)</span>

            <span class="c1"># set up a scroll area</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scrollArea</span> <span class="o">=</span> <span class="n">ScrollArea</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scrollArea</span><span class="o">.</span><span class="n">setWidgetResizable</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scrollArea</span><span class="o">.</span><span class="n">setWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_scrollArea</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;ScrollArea { border: 0px; background: transparent; }&quot;&quot;&quot;</span><span class="p">)</span>

        <span class="c1"># self.mainWidget.setSizePolicy(QtWidgets.QSizePolicy.Ignored, QtWidgets.QSizePolicy.Ignored)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">MinimumExpanding</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">MinimumExpanding</span><span class="p">)</span>
        <span class="c1"># self._scrollArea.setSizePolicy(QtWidgets.QSizePolicy.MinimumExpanding, QtWidgets.QSizePolicy.MinimumExpanding)</span>
        <span class="c1"># self._scrollArea.setSizePolicy(QtWidgets.QSizePolicy.Ignored, QtWidgets.QSizePolicy.Ignored)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="o">.</span><span class="n">getLayout</span><span class="p">()</span><span class="o">.</span><span class="n">setSpacing</span><span class="p">(</span><span class="n">DEFAULTSPACING</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_buttonOptions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># keep a record of how many times the apply button has been pressed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># clear the changes list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setDefaultButton</span><span class="p">()</span>

        <span class="c1"># GST stops a file icon being shown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFilePath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">__postInit__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;post initialise functions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setButtons</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_setDialogSize</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">getButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">getButton</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_setDialogSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the fixed/free dialog size from size or sizeHint</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">size</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># check whether the size has been defined</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;size is not defined correctly: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">list</span><span class="p">))</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;size is not the correct length: </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">))</span>

            <span class="n">size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_size</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">,</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">)</span> <span class="k">else</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSize</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">_size</span><span class="p">)</span>

        <span class="c1"># set the fixed sized policies as requird</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FIXEDWIDTH</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFixedWidth</span><span class="p">(</span><span class="n">size</span><span class="o">.</span><span class="n">width</span><span class="p">()</span> <span class="k">if</span> <span class="n">size</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FIXEDHEIGHT</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFixedHeight</span><span class="p">(</span><span class="n">size</span><span class="o">.</span><span class="n">height</span><span class="p">()</span> <span class="k">if</span> <span class="n">size</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">())</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mainWidget</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FIXEDWIDTH</span> <span class="k">else</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Preferred</span><span class="p">,</span>
                                      <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FIXEDHEIGHT</span> <span class="k">else</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Preferred</span><span class="p">,</span> <span class="p">)</span>

<div class="viewcode-block" id="CcpnDialogMainWidget.setOkButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setOkButton">[docs]</a>    <span class="k">def</span> <span class="nf">setOkButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Apply changes and close&#39;</span><span class="p">,</span>
                    <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/dialog-apply.png&#39;</span><span class="p">,</span>
                    <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an Ok button to the dialog box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addButton</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">OKBUTTON</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                               <span class="n">texts</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">tipTexts</span><span class="o">=</span><span class="n">tipText</span><span class="p">,</span> <span class="n">icons</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span>
                               <span class="n">enabledStates</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="n">visibleStates</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.setCloseButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setCloseButton">[docs]</a>    <span class="k">def</span> <span class="nf">setCloseButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Keep all applied changes and close&#39;</span><span class="p">,</span>
                       <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/window-close&#39;</span><span class="p">,</span>
                       <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Close button to the dialog box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addButton</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CLOSEBUTTON</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                               <span class="n">texts</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">tipTexts</span><span class="o">=</span><span class="n">tipText</span><span class="p">,</span> <span class="n">icons</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span>
                               <span class="n">enabledStates</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="n">visibleStates</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.setCancelButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setCancelButton">[docs]</a>    <span class="k">def</span> <span class="nf">setCancelButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Roll-back all applied changes and close&#39;</span><span class="p">,</span>
                        <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/window-close&#39;</span><span class="p">,</span>
                        <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Cancel button to the dialog box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addButton</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">CANCELBUTTON</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                               <span class="n">texts</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">tipTexts</span><span class="o">=</span><span class="n">tipText</span><span class="p">,</span> <span class="n">icons</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span>
                               <span class="n">enabledStates</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="n">visibleStates</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.setRevertButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setRevertButton">[docs]</a>    <span class="k">def</span> <span class="nf">setRevertButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="s1">&#39;Revert&#39;</span><span class="p">,</span>
                        <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Roll-back all applied changes&#39;</span><span class="p">,</span>
                        <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/undo&#39;</span><span class="p">,</span>
                        <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Revert button to the dialog box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addButton</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                               <span class="n">texts</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">tipTexts</span><span class="o">=</span><span class="n">tipText</span><span class="p">,</span> <span class="n">icons</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span>
                               <span class="n">enabledStates</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="n">visibleStates</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.setHelpButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setHelpButton">[docs]</a>    <span class="k">def</span> <span class="nf">setHelpButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Help&#39;</span><span class="p">,</span>
                      <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/system-help&#39;</span><span class="p">,</span>
                      <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add a Help button to the dialog box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addButton</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">HELPBUTTON</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                               <span class="n">texts</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">tipTexts</span><span class="o">=</span><span class="n">tipText</span><span class="p">,</span> <span class="n">icons</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span>
                               <span class="n">enabledStates</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="n">visibleStates</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.setApplyButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setApplyButton">[docs]</a>    <span class="k">def</span> <span class="nf">setApplyButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Apply changes&#39;</span><span class="p">,</span>
                       <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/orange-apply&#39;</span><span class="p">,</span>
                       <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an Apply button to the dialog box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addButton</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                               <span class="n">texts</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">tipTexts</span><span class="o">=</span><span class="n">tipText</span><span class="p">,</span> <span class="n">icons</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span>
                               <span class="n">enabledStates</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="n">visibleStates</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.setUserButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setUserButton">[docs]</a>    <span class="k">def</span> <span class="nf">setUserButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">tipText</span><span class="o">=</span><span class="s1">&#39;Apply changes to all spectra&#39;</span><span class="p">,</span>
                      <span class="n">icon</span><span class="o">=</span><span class="s1">&#39;icons/orange-apply&#39;</span><span class="p">,</span>
                      <span class="n">enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">visible</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add an Apply button to the dialog box</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_addButton</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">callback</span><span class="p">,</span>
                               <span class="n">texts</span><span class="o">=</span><span class="n">text</span><span class="p">,</span> <span class="n">tipTexts</span><span class="o">=</span><span class="n">tipText</span><span class="p">,</span> <span class="n">icons</span><span class="o">=</span><span class="n">icon</span><span class="p">,</span>
                               <span class="n">enabledStates</span><span class="o">=</span><span class="n">enabled</span><span class="p">,</span> <span class="n">visibleStates</span><span class="o">=</span><span class="n">visible</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_addButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add button settings to the buttonList</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Error: cannot add buttons after __init__&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwds</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buttonOptions</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_buttonOptions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">,)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_buttonOptions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">v</span><span class="p">,)</span>

    <span class="k">def</span> <span class="nf">_setButtons</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the buttons for the dialog</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">grid</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_orientation</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span> <span class="o">=</span> <span class="n">DialogButtonBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span>
                                             <span class="n">orientation</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_orientation</span><span class="p">,</span>
                                             <span class="n">defaultButton</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_defaultButton</span><span class="p">,</span>
                                             <span class="n">enableIcons</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ENABLEICONS</span><span class="p">,</span>
                                             <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_buttonOptions</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="CcpnDialogMainWidget.setDefaultButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.setDefaultButton">[docs]</a>    <span class="k">def</span> <span class="nf">setDefaultButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="o">=</span><span class="n">CLOSEBUTTON</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Set the default dialog button</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_defaultButton</span> <span class="o">=</span> <span class="n">button</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.getButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.getButton">[docs]</a>    <span class="k">def</span> <span class="nf">getButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buttonName</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the button from the buttonNames defined in the class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">buttonName</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialogMainWidget.fixedSize"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.fixedSize">[docs]</a>    <span class="k">def</span> <span class="nf">fixedSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span><span class="o">.</span><span class="n">setHorizontalStretch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span><span class="o">.</span><span class="n">setVerticalStretch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maximumWidth</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximumHeight</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizeGripEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_revertClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Revert button signal comes here</span>
<span class="sd">        Revert (roll-back) the state of the project to before the popup was opened</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">_undo</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">undos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">_undo</span><span class="o">.</span><span class="n">undo</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_cancelClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Cancel button signal comes here</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_revertClicked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_closeClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Close button signal comes here</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reject</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_applyClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Apply button signal comes here</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_applyChanges</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_okClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;OK button signal comes here</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_applyChanges</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_helpClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Help button signal comes here</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_applyAllChanges</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">changes</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Execute the Apply/OK functions</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">changes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">v</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_applyChanges</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The apply button has been clicked</span>
<span class="sd">        Define an undo block for setting the properties of the object</span>
<span class="sd">        If there is an error setting any values then generate an error message</span>
<span class="sd">          If anything has been added to the undo queue then remove it with application.undo()</span>
<span class="sd">          repopulate the popup widgets</span>

<span class="sd">        This is controlled by a series of dicts that contain change functions - operations that are scheduled</span>
<span class="sd">        by changing items in the popup. These functions are executed when the Apply or OK buttons are clicked</span>

<span class="sd">        Return True unless any errors occurred</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">EDITMODE</span><span class="p">:</span>
            <span class="c1"># get the list of widgets that have been changed - exit if all empty</span>
            <span class="n">allChanges</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">allChanges</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>

        <span class="c1"># handle clicking of the Apply/OK button</span>
        <span class="k">with</span> <span class="n">handleDialogApply</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>

            <span class="c1"># add item here to redraw items</span>
            <span class="k">with</span> <span class="n">undoStackBlocking</span><span class="p">()</span> <span class="k">as</span> <span class="n">addUndoItem</span><span class="p">:</span>
                <span class="n">addUndoItem</span><span class="p">(</span><span class="n">undo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_refreshGLItems</span><span class="p">)</span>

            <span class="c1"># apply all functions to the object</span>
            <span class="n">changes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span>
            <span class="k">if</span> <span class="n">changes</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">EDITMODE</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_applyAllChanges</span><span class="p">(</span><span class="n">changes</span><span class="p">)</span>

            <span class="c1"># add item here to redraw items</span>
            <span class="k">with</span> <span class="n">undoStackBlocking</span><span class="p">()</span> <span class="k">as</span> <span class="n">addUndoItem</span><span class="p">:</span>
                <span class="n">addUndoItem</span><span class="p">(</span><span class="n">redo</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_refreshGLItems</span><span class="p">)</span>

            <span class="c1"># redraw the items</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_refreshGLItems</span><span class="p">()</span>

        <span class="c1"># everything has happened - disable the apply button</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">APPLYBUTTON</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

        <span class="c1"># check for any errors</span>
        <span class="k">if</span> <span class="n">error</span><span class="o">.</span><span class="n">errorValue</span><span class="p">:</span>
            <span class="c1"># repopulate popup on an error</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_populate</span><span class="p">()</span>
            <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># remove all changes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RESETBUTTON</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="nf">_refreshGLItems</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;emit a signal to rebuild any required GL items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># MUST BE SUBCLASSED</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Code error: function not implemented&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="CcpnDialogMainWidget.getActiveTabList"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialogMainWidget.getActiveTabList">[docs]</a>    <span class="k">def</span> <span class="nf">getActiveTabList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get a list of tabs for calulating the changes to settings</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># MUST BE SUBCLASSED</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Code error: function not implemented&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="CcpnDialog"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialog">[docs]</a><span class="k">class</span> <span class="nc">CcpnDialog</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialog</span><span class="p">,</span> <span class="n">Base</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to handle popup dialogs</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">REVERTBUTTONTEXT</span> <span class="o">=</span> <span class="s1">&#39;Revert&#39;</span>
    <span class="n">CANCELBUTTONTEXT</span> <span class="o">=</span> <span class="s1">&#39;Cancel&#39;</span>
    <span class="n">CLOSEBUTTONTEXT</span> <span class="o">=</span> <span class="s1">&#39;Close&#39;</span>
    <span class="n">APPLYBUTTONTEXT</span> <span class="o">=</span> <span class="s1">&#39;Apply&#39;</span>
    <span class="n">OKBUTTONTEXT</span> <span class="o">=</span> <span class="s1">&#39;OK&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">windowTitle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="n">Base</span><span class="o">.</span><span class="n">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">setLayout</span><span class="o">=</span><span class="n">setLayout</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">windowTitle</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setContentsMargins</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="o">*</span><span class="n">size</span><span class="p">)</span>

        <span class="c1"># GST stops a file icon being shown</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowFilePath</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowIcon</span><span class="p">(</span><span class="n">QtGui</span><span class="o">.</span><span class="n">QIcon</span><span class="p">())</span>

<div class="viewcode-block" id="CcpnDialog.fixedSize"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialog.fixedSize">[docs]</a>    <span class="k">def</span> <span class="nf">fixedSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span><span class="o">.</span><span class="n">setHorizontalStretch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span><span class="o">.</span><span class="n">setVerticalStretch</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sizePolicy</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setFixedSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maximumWidth</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximumHeight</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setSizeGripEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="CcpnDialog.setDefaultButton"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.CcpnDialog.setDefaultButton">[docs]</a>    <span class="k">def</span> <span class="nf">setDefaultButton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">button</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">button</span><span class="p">,</span> <span class="n">QtWidgets</span><span class="o">.</span><span class="n">QPushButton</span><span class="p">):</span>
            <span class="n">button</span><span class="o">.</span><span class="n">setDefault</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">button</span><span class="o">.</span><span class="n">setAutoDefault</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> is not a button&#39;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">button</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="dialogErrorReport"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.dialogErrorReport">[docs]</a><span class="k">def</span> <span class="nf">dialogErrorReport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">undo</span><span class="p">,</span> <span class="n">es</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show warning popup and check the undo stack for items that need to be culled</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">ccpn.ui.gui.widgets.MessageDialog</span> <span class="kn">import</span> <span class="n">showWarning</span>

    <span class="n">showWarning</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">windowTitle</span><span class="p">()),</span> <span class="nb">str</span><span class="p">(</span><span class="n">es</span><span class="p">))</span>

    <span class="c1"># should only undo if something new has been added to the undo deque</span>
    <span class="c1"># may cause a problem as some things may be set with the same values</span>
    <span class="c1"># and still be added to the change list, so only undo if length has changed</span>

    <span class="c1"># get the name of the class propagating the error</span>
    <span class="n">errorName</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">undo</span><span class="o">.</span><span class="n">newItemsAdded</span><span class="p">:</span>
        <span class="c1"># undo any valid items and clear the stack above the current undo point</span>
        <span class="n">undo</span><span class="o">.</span><span class="n">undo</span><span class="p">()</span>
        <span class="n">undo</span><span class="o">.</span><span class="n">clearRedoItems</span><span class="p">()</span>

        <span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&gt;Undo.</span><span class="si">%s</span><span class="s1">._applychanges&#39;</span> <span class="o">%</span> <span class="n">errorName</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&gt;Undo.</span><span class="si">%s</span><span class="s1">._applychanges nothing to remove&#39;</span> <span class="o">%</span> <span class="n">errorName</span><span class="p">)</span></div>


<div class="viewcode-block" id="handleDialogApply"><a class="viewcode-back" href="../../../../../ccpn/ccpn.ui.gui.popups.html#ccpn.ui.gui.popups.Dialog.handleDialogApply">[docs]</a><span class="nd">@contextmanager</span>
<span class="k">def</span> <span class="nf">handleDialogApply</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Context manager to wrap the apply button for dialogs</span>
<span class="sd">    Error trapping is contained inside the undoBlock, any error raised is placed in</span>
<span class="sd">    the errorValue of the yielded object and a warning popup is raised</span>

<span class="sd">    e.g.</span>

<span class="sd">        with handleDialogApply(self) as error:</span>
<span class="sd">            ...  code block here ...</span>

<span class="sd">        if error.errorValue:</span>
<span class="sd">            # an error occurred in the code block</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="kn">from</span> <span class="nn">ccpn.core.lib.ContextManagers</span> <span class="kn">import</span> <span class="n">undoBlock</span>

    <span class="n">undo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">project</span><span class="o">.</span><span class="n">_undo</span>


    <span class="c1"># object to hold the error value</span>
    <span class="k">class</span> <span class="nc">errorContent</span><span class="p">():</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">errorValue</span> <span class="o">=</span> <span class="kc">None</span>


    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># add an undoBlock</span>
        <span class="k">with</span> <span class="n">undoBlock</span><span class="p">():</span>

            <span class="c1"># transfer control to the calling function</span>
            <span class="n">error</span> <span class="o">=</span> <span class="n">errorContent</span><span class="p">()</span>
            <span class="k">yield</span> <span class="n">error</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">es</span><span class="p">:</span>

        <span class="c1"># if an error occurs, report as a warning popup and return error to the calling method</span>
        <span class="n">dialogErrorReport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">undo</span><span class="p">,</span> <span class="n">es</span><span class="p">)</span>
        <span class="n">error</span><span class="o">.</span><span class="n">errorValue</span> <span class="o">=</span> <span class="n">es</span>

        <span class="c1"># re-raise the error if in debug mode</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">_isInDebugMode</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">es</span></div>


<span class="k">def</span> <span class="nf">_verifyPopupApply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributeName</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">postArgs</span><span class="p">,</span> <span class="o">**</span><span class="n">postKwds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Change the state of the apply button based on the changes in the tabs</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># if attributeName is defined use as key to dict to store change functions</span>
    <span class="c1"># append postFixes if need to differentiate partial functions</span>
    <span class="k">if</span> <span class="n">attributeName</span><span class="p">:</span>

        <span class="c1"># append the extra parameters to the end of attributeName to give a unique</span>
        <span class="c1"># identifier into _changes dict, to differentiate same-name partial functions</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">postArgs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">postKwds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
        <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="c1"># store in dict - overwrite as required</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">[</span><span class="n">attributeName</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attributeName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span>
                <span class="c1"># delete from dict - empty dict implies no changes</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">[</span><span class="n">attributeName</span><span class="p">]</span>

        <span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">debug2</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&gt;attrib </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attributeName</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">[</span><span class="n">attributeName</span><span class="p">]</span> <span class="k">if</span> <span class="n">attributeName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="k">else</span> <span class="s1">&#39;None&#39;</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;LIVEDIALOG&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_changeSettings</span><span class="p">()</span>

    <span class="k">if</span> <span class="bp">self</span><span class="p">:</span>
        <span class="c1"># set button state depending on number of changes</span>
        <span class="n">allChanges</span> <span class="o">=</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span> <span class="k">else</span> <span class="kc">False</span>
        <span class="n">_button</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Apply</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_button</span><span class="p">:</span>
            <span class="n">_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">allChanges</span><span class="p">)</span>
        <span class="n">_button</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Reset</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_button</span><span class="p">:</span>
            <span class="n">_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">allChanges</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_currentNumApplies</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_verifyPopupTabApply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributeName</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">postArgs</span><span class="p">,</span> <span class="o">**</span><span class="n">postKwds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Change the state of the apply button based on the changes in the tabs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># self must be a tab in a tabWidget</span>
    <span class="n">popup</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span>

    <span class="c1"># if attributeName is defined use as key to dict to store change functions</span>
    <span class="c1"># append postFixes if need to differentiate partial functions</span>
    <span class="k">if</span> <span class="n">attributeName</span><span class="p">:</span>

        <span class="c1"># append the extra parameters to the end of attributeName to give a unique</span>
        <span class="c1"># identifier into _changes dict, to differentiate same-name partial functions</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">postArgs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">postKwds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
        <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="c1"># store in dict - overwrite as required</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">[</span><span class="n">attributeName</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attributeName</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">:</span>
                <span class="c1"># delete from dict - empty dict implies no changes</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_changes</span><span class="p">[</span><span class="n">attributeName</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">popup</span><span class="p">:</span>
        <span class="c1"># check whether there is a list of tabs</span>
        <span class="n">tabs</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">getActiveTabList</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">tabs</span><span class="p">:</span>
            <span class="c1"># set button state depending on number of changes</span>
            <span class="c1"># tabs = tuple(tabWidget.widget(ii) for ii in range(tabWidget.count()))</span>

            <span class="n">allChanges</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">_changes</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tabs</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">_button</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Apply</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_button</span><span class="p">:</span>
                <span class="n">_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">allChanges</span><span class="p">)</span>
            <span class="n">_button</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Reset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_button</span><span class="p">:</span>
                <span class="n">_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">allChanges</span> <span class="ow">or</span> <span class="n">popup</span><span class="o">.</span><span class="n">_currentNumApplies</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_verifyPopupChangesApply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attributeName</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">*</span><span class="n">postArgs</span><span class="p">,</span> <span class="o">**</span><span class="n">postKwds</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Change the state of the apply button based on the changes in the tabs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># self must be a tab in a tabWidget</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GETCHANGESDICT</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;Error: widget must have changes defined&#39;</span><span class="p">)</span>

    <span class="n">popup</span><span class="p">,</span> <span class="n">_changeDict</span><span class="p">,</span> <span class="n">stateValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getChangesDict</span><span class="p">()</span>

    <span class="c1"># if attributeName is defined use as key to dict to store change functions</span>
    <span class="c1"># append postFixes if need to differentiate partial functions</span>
    <span class="k">if</span> <span class="n">attributeName</span><span class="p">:</span>

        <span class="c1"># append the extra parameters to the end of attributeName to give a unique</span>
        <span class="c1"># identifier into _changes dict, to differentiate same-name partial functions</span>
        <span class="k">for</span> <span class="n">pf</span> <span class="ow">in</span> <span class="n">postArgs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">pf</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">postKwds</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">pf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pf</span><span class="p">)</span>
        <span class="n">attributeName</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">id</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">value</span><span class="p">:</span>
            <span class="c1"># store in dict - overwrite as required</span>
            <span class="n">_changeDict</span><span class="p">[</span><span class="n">attributeName</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">attributeName</span> <span class="ow">in</span> <span class="n">_changeDict</span><span class="p">:</span>
                <span class="c1"># delete from dict - empty dict implies no changes</span>
                <span class="k">del</span> <span class="n">_changeDict</span><span class="p">[</span><span class="n">attributeName</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">popup</span><span class="p">:</span>
        <span class="c1"># check whether there is a list of tabs</span>
        <span class="n">tabs</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">getActiveTabList</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">tabs</span><span class="p">:</span>
            <span class="c1"># set button state depending on number of changes</span>
            <span class="c1"># tabs = tuple(tabWidget.widget(ii) for ii in range(tabWidget.count()))</span>

            <span class="n">allChanges</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">_changes</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tabs</span> <span class="k">if</span> <span class="n">t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="n">stateValue</span>
            <span class="n">_button</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Apply</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_button</span><span class="p">:</span>
                <span class="n">_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">allChanges</span><span class="p">)</span>
            <span class="n">_button</span> <span class="o">=</span> <span class="n">popup</span><span class="o">.</span><span class="n">dialogButtons</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">QtWidgets</span><span class="o">.</span><span class="n">QDialogButtonBox</span><span class="o">.</span><span class="n">Reset</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_button</span><span class="p">:</span>
                <span class="n">_button</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="n">allChanges</span> <span class="ow">or</span> <span class="n">popup</span><span class="o">.</span><span class="n">_currentNumApplies</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../../../index.html">Python  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright .
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.4.0.
    </div>
  </body>
</html>