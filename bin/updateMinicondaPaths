#!/usr/bin/env bash
# Configure the paths inside the release miniconda directory

ROOT="${HOME}/release/ccpnmr3.0.0/miniconda"
PATHFROM="${HOME}/miniconda3/envs/ccpnmr_distqt5"
PATHTO="${HOME}/release/ccpnmr3.0.0/miniconda"

export CCPNMR_TOP_DIR="$(dirname "$(cd "$(dirname "$0")" || exit; pwd)")"
export ANACONDA3=${CCPNMR_TOP_DIR}/miniconda
export PYTHONPATH=${CCPNMR_TOP_DIR}/src/python:${CCPNMR_TOP_DIR}/src/c
export FONTCONFIG_FILE=${ANACONDA3}/etc/fonts/fonts.conf
export FONTCONFIG_PATH=${ANACONDA3}/etc/fonts
export QT_PLUGIN_PATH=${QT_PLUGIN_PATH}:${ANACONDA3}/plugins

if [[ "$(uname -s)" == 'Darwin' ]]; then
  export DYLD_FALLBACK_LIBRARY_PATH=/System/Library/Frameworks/ApplicationServices.framework/Versions/A/Frameworks/ImageIO.framework/Versions/A/Resources:
  export DYLD_FALLBACK_LIBRARY_PATH=${DYLD_FALLBACK_LIBRARY_PATH}${ANACONDA3}/lib:
  export DYLD_FALLBACK_LIBRARY_PATH=${DYLD_FALLBACK_LIBRARY_PATH}${ANACONDA3}/lib/python3.5/site-packages/PyQt5:
  export DYLD_FALLBACK_LIBRARY_PATH=${DYLD_FALLBACK_LIBRARY_PATH}${HOME}/lib:/usr/local/lib:/usr/lib
fi

${ANACONDA3}/bin/python ${CCPNMR_TOP_DIR}/src/python/ccpn/util/convertPaths.py $ROOT $PATHFROM $PATHTO
